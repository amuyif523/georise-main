
> backend@1.0.0 test
> dotenv -e .env.test -- vitest run test/userRbac.test.ts


[1m[7m[36m RUN [39m[27m[22m [36mv2.1.9 [39m[90mC:/Users/Amanuel/Desktop/georise-main/backend[39m

[90mstdout[2m | test/userRbac.test.ts
[22m[39m[dotenv@17.2.3] injecting env (0) from .env.test -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit

{"level":30,"time":1770651333374,"pid":6392,"hostname":"DESKTOP-3P240QT","msg":"Incident AI Queue initialized"}
node.exe : Sourcemap for "
C:/Users/Amanuel/Desktop/g
eorise-main/node_modules/n
ode-cron/dist/esm/node-cro
n.js" points to missing 
source files
At C:\Program 
Files\nodejs\npm.ps1:29 
char:3
+   & $NODE_EXE 
$NPM_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~
    + CategoryInfo        
      : NotSpecified: (S  
  ourcemap for "...ng s   
 ource files:String) [    
], RemoteException
    + FullyQualifiedError 
   Id : NativeCommandErr  
  or
 
{"level":50,"time":1770651334516,"pid":6392,"hostname":"DESKTOP-3P240QT","err":{"type":"Error","message":"Account is inactive","stack":"Error: Account is inactive\n    at AuthService.login (C:\\Users\\Amanuel\\Desktop\\georise-main\\backend\\src\\modules\\auth\\auth.service.ts:174:13)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at login (C:\\Users\\Amanuel\\Desktop\\georise-main\\backend\\src\\modules\\auth\\auth.controller.ts:18:20)"},"msg":"Login error"}
{"level":50,"time":1770651334700,"pid":6392,"hostname":"DESKTOP-3P240QT","err":{"type":"Error","message":"User not active","stack":"Error: User not active\n    at AuthService.rotateRefresh (C:\\Users\\Amanuel\\Desktop\\georise-main\\backend\\src\\modules\\auth\\auth.service.ts:255:71)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at C:\\Users\\Amanuel\\Desktop\\georise-main\\backend\\src\\modules\\auth\\refresh.routes.ts:12:20"},"msg":"Refresh token error"}
 [32mΓ£ô[39m test/userRbac.test.ts [2m([22m[2m2 tests[22m[2m)[22m[33m 713[2mms[22m[39m
   [33m[2mΓ£ô[22m[39m User RBAC and deactivation[2m > [22mblocks login and refresh for deactivated users [33m370[2mms[22m[39m
   [33m[2mΓ£ô[22m[39m User RBAC and deactivation[2m > [22mprevents agency staff from mutating users in other agencies [33m322[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m2 passed[39m[22m[90m (2)[39m
[2m   Start at [22m 18:35:31
[2m   Duration [22m 4.06s[2m (transform 787ms, setup 132ms, collect 2.52s, tests 713ms, environment 1ms, prepare 493ms)[22m

